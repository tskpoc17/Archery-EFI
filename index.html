<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>EFI å°„ç®­è¨ˆç®—æ©Ÿ</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 20px; margin: 0; }
        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { text-align: center; color: #333; margin-top: 0; margin-bottom: 20px; }
        label { font-weight: bold; font-size: 14px; color: #555; display: block; margin-top: 15px; margin-bottom: 5px; }
        
        /* è®“è¼¸å…¥æ¡†å’Œé¸å–®çœ‹èµ·ä¾†ä¸€æ¨£æ¼‚äº® */
        input, select { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ddd; 
            border-radius: 10px; 
            box-sizing: border-box; 
            font-size: 16px; 
            background-color: #fff;
            appearance: none; /* ç§»é™¤é è¨­æ¨£å¼è®“æ‰‹æ©Ÿç‰ˆæ›´å¥½çœ‹ */
        }
        
        /* ç‰¹åˆ¥å¹«é¸å–®åŠ ä¸€å€‹ä¸‹æ‹‰ç®­é ­ç¬¦è™Ÿï¼Œæ¯”è¼ƒå¥½è¾¨è­˜ */
        select {
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007AFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 15px top 50%;
            background-size: 12px auto;
        }

        button { width: 100%; padding: 15px; background: #007AFF; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 25px; transition: background 0.2s; }
        button:active { background: #0056b3; transform: scale(0.98); }
        
        .res { margin-top: 25px; padding: 20px; background: #f0f9ff; border-radius: 12px; text-align: center; border: 1px solid #bce0fd; }
        .hint { font-size: 12px; color: #888; margin-top: 5px; }
    </style>
</head>
<body>
<div class="card">
    <h2>ğŸ¯ EFI å°„ç®­è¨ˆç®—æ©Ÿ</h2>

    <label>é¸æ“‡é¶ç´™å¤§å°</label>
    <select id="faceSize">
        <option value="122">ğŸ”´ 122cm (70m/60m æ¨™æº–å¤§é¶)</option>
        <option value="80">ğŸ”µ 80cm (50m/30m è¼ƒå°é¶)</option>
        <option value="40">ğŸŸ¢ 40cm (18m å®¤å…§ä¸‰ç’°/å–®é¶)</option>
    </select>
    <div class="hint">å¦‚æœä¸ç¢ºå®šç›´å¾‘ï¼Œè«‹ä¾æ“šæ¯”è³½è·é›¢é¸æ“‡</div>

    <label>12 ç®­ X åº§æ¨™ (é€—é»éš”é–‹)</label>
    <input type="text" id="coords" placeholder="ä¾‹å¦‚: 1.2, -0.5, 3.1..." inputmode="decimal">
    
    <label>K å€¼ (è·é›¢ä¿®æ­£ä¿‚æ•¸)</label>
    <input type="number" id="kValue" value="1" step="0.1">
    
    <button onclick="calc()">è¨ˆç®— EFI</button>
    
    <div id="out" class="res" style="display:none;">
        <div style="font-size: 14px; color: #555; margin-bottom: 5px;">EFI å™¨æå¯¬å®¹æ€§æŒ‡æ¨™</div>
        <strong id="val" style="font-size: 36px; color: #007AFF;"></strong>
    </div>
</div>

<script>
function calc() {
    const s = 10;
    // é€™è£¡æœƒç›´æ¥æŠ“å–é¸å–®é¸ä¸­çš„ value (122, 80 æˆ– 40)
    const d = parseFloat(document.getElementById('faceSize').value);
    
    const k = parseFloat(document.getElementById('kValue').value);
    const x = document.getElementById('coords').value.split(',').map(Number).filter(n => !isNaN(n));

    if (x.length < 2) return alert("è«‹è¼¸å…¥è‡³å°‘å…©å€‹åº§æ¨™æ•¸å€¼");
    
    const avg = x.reduce((a, b) => a + b) / x.length;
    const R = x.filter(v => v >= avg), L = x.filter(v => v < avg);
    
    const m = (arr) => {
        if (!arr.length) return 0;
        const a = arr.reduce((p,c)=>p+c)/arr.length;
        return arr.reduce((p,c)=>p+Math.abs(c-a),0)/arr.length;
    };
    
    const dR = R.length ? Math.abs((R.reduce((a,b)=>a+b)/R.length) - avg) : 0;
    const dL = L.length ? Math.abs((L.reduce((a,b)=>a+b)/L.length) - avg) : 0;
    
    const penalty = (k * dR) + (k * dL) + (k * (m(R) * R.length + m(L) * L.length) / x.length);
    
    document.getElementById('out').style.display = 'block';
    document.getElementById('val').innerText = (s * ((d - penalty) / d) + 1).toFixed(4);
}
</script>
</body>
</html>
